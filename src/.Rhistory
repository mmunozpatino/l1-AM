source('/media/fernando/Archivos/Documents/aprendizaje de maquinas/l1/src/dt.R')
source('/media/fernando/Archivos/Documents/aprendizaje de maquinas/l1/src/dt.R')
detach("package:utils", unload=TRUE)
library("utils", lib.loc="/usr/lib/R/library")
source('/media/fernando/Archivos/Documents/aprendizaje de maquinas/l1/src/dt.R')
source('/media/fernando/Archivos/Documents/aprendizaje de maquinas/l1/src/dt.R')
setwd("~/Documents/aprendizaje de m√°quinas/l1-AM/src")
setwd("../src/") # configurar el directorio de trabajo en src
source("read-matrix.R")
m.train <- read_matrix(filename="../data/MATRIX.TRAIN",ocurrence=FALSE,sparse=FALSE)
# Acceso a componetes: m.train$tokens y m.train$matrix
tokens <- m.train$tokens
trainset <- m.train$matrix
names(trainset) <- c(m.train$tokens,"category")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
library(ggplot2)
install.packages("ggplot2")
setwd("../src/") # configurar el directorio de trabajo en src
source("read-matrix.R")
m.train <- read_matrix(filename="../data/MATRIX.TRAIN",ocurrence=FALSE,sparse=FALSE)
# Acceso a componetes: m.train$tokens y m.train$matrix
tokens <- m.train$tokens
trainset <- m.train$matrix
names(trainset) <- c(m.train$tokens,"category")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
nspan<- which(m.train$matrix$category == "SPAM")
print(length(nspan))
pSpan <- length(nspan)/nrow(m.train$matrix)
ggplot(data=trainset)+
geom_bar(aes(x = 1, y = pSpan ), alpha = 0.3, color = "red" )+
geom_bar(aes(x = 2, y = (1-pSpan) ))
library("ggplot2", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
nspan<- which(m.train$matrix$category == "SPAM")
print(length(nspan))
pSpan <- length(nspan)/nrow(m.train$matrix)
ggplot(data=trainset)+
geom_bar(aes(x = 1, y = pSpan ), alpha = 0.3, color = "red" )+
geom_bar(aes(x = 2, y = (1-pSpan) ))
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
library(ggplot2)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red")) + geom_bar(stat="identity")+ ggtitle("Distribuci?n de clases") + labs(x="Categorias", y ="Distribuci?n(%)")
# en este caso estamos usando las propiedades visuales x y fill (relleno)
setwd("../src/") # configurar el directorio de trabajo en src
source("read-matrix.R")
m.train <- read_matrix(filename="../data/MATRIX.TRAIN",ocurrence=FALSE,sparse=FALSE)
# Acceso a componetes: m.train$tokens y m.train$matrix
tokens <- m.train$tokens
trainset <- m.train$matrix
names(trainset) <- c(m.train$tokens,"category")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
library(ggplot2)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red")) + geom_bar(stat="identity")+ ggtitle("Distribuci?n de clases") + labs(x="Categorias", y ="Distribuci?n(%)")
# en este caso estamos usando las propiedades visuales x y fill (relleno)
# instalar las librerias rpart,rpart.plot
library("rpart")
library("rpart.plot")
install.packages("rpart.plot")
library("rpart.plot", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
# instalar las librerias rpart,rpart.plot
library("rpart")
library("rpart.plot")
tree.model <- rpart(formula=category~.,data=trainset)
# prp(tree.model)
colCategory <- ncol(trainset)
m.pred <- predict(tree.model, trainset[-colCategory])
aux.pred <- as.matrix(m.pred[,1])
aux.pred[aux.pred>=0.5] <- "SPAM"
aux.pred[aux.pred<0.5] <- "NO-SPAM"
aux.true <- trainset[colCategory]
result <- cbind(aux.true,aux.pred,aux.true==aux.pred)
names(result) <- c("TRUE-VALUE", "PREDICTION", "CORRECT?")
print(result)
#INSERTAR CODIGO AQUI
# matriz <- trainset[1:(ncol(m.train$matrix)-1)]
# rdo <- sort(colSums(matriz), decreasing = TRUE)
rdospam <- trainset[which(m.train$matrix$category == "SPAM"), 1:(ncol(m.train$matrix)-1)]
cantrepetespam <- sort(colSums(rdospam), decreasing = TRUE)
rdoNospam <- trainset[which(m.train$matrix$category == "NO-SPAM"), 1:(ncol(m.train$matrix)-1)]
cantrepetNoSpam <- sort(colSums(rdoNospam), decreasing = TRUE)
grafspam <- data.frame(names(cantrepetespam)[1:7], cantrepetespam[1:7])
grafnospam <- data.frame(names(cantrepetNoSpam)[1:7], cantrepetNoSpam[1:7])
ggplot(data= grafspam) +
geom_bar(aes(x=grafspam$names.cantrepetespam., y= grafspam$cantrepetespam), stat="identity", fill="red",alpha=0.3) +
ggtitle("Distribuci?n") +
labs(x="Palabra",y="Frecuencia")+
geom_bar(aes(x=grafnospam$names.cantrepetNoSpam., y= grafnospam$cantrepetNoSpam), stat="identity", fill="blue",alpha=0.3)
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
library(ggplot2)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red")) + geom_bar(stat="identity")+ ggtitle("Distribuci?n de clases") + labs(x="Categorias", y ="Distribuci?n(%)")
# en este caso estamos usando las propiedades visuales x y fill (relleno)
#INSERTAR CODIGO AQUI
# matriz <- trainset[1:(ncol(m.train$matrix)-1)]
# rdo <- sort(colSums(matriz), decreasing = TRUE)
rdospam <- trainset[which(m.train$matrix$category == "SPAM"), 1:(ncol(m.train$matrix)-1)]
cantrepetespam <- sort(colSums(rdospam), decreasing = TRUE)
rdoNospam <- trainset[which(m.train$matrix$category == "NO-SPAM"), 1:(ncol(m.train$matrix)-1)]
cantrepetNoSpam <- sort(colSums(rdoNospam), decreasing = TRUE)
grafspam <- data.frame(names(cantrepetespam)[1:7], cantrepetespam[1:7])
grafnospam <- data.frame(names(cantrepetNoSpam)[1:7], cantrepetNoSpam[1:7])
ggplot(data= grafspam) +
geom_bar(aes(x=grafspam$names.cantrepetespam., y= grafspam$cantrepetespam), stat="identity", fill="red",alpha=0.3) +
ggtitle("Distribuci?n") +
labs(x="Palabra",y="Frecuencia")+
geom_bar(aes(x=grafnospam$names.cantrepetNoSpam., y= grafnospam$cantrepetNoSpam), stat="identity", fill="blue",alpha=0.3)
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="red", alpha=0.3, color="red")+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="blue", alpha=0.3, color="blue")+
ggtitle('Mails')+
labs(x="palabra", y = "")
# instalar las librerias rpart,rpart.plot
library("rpart")
library("rpart.plot")
tree.model <- rpart(formula=category~.,data=trainset)
# prp(tree.model)
colCategory <- ncol(trainset)
m.pred <- predict(tree.model, trainset[-colCategory])
aux.pred <- as.matrix(m.pred[,1])
aux.pred[aux.pred>=0.5] <- "SPAM"
aux.pred[aux.pred<0.5] <- "NO-SPAM"
aux.true <- trainset[colCategory]
result <- cbind(aux.true,aux.pred,aux.true==aux.pred)
names(result) <- c("TRUE-VALUE", "PREDICTION", "CORRECT?")
print(result)
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="green", alpha=0.3, color="red")+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="AA0033", alpha=0.3, color="blue")+
ggtitle('Mails')+
labs(x="palabra", y = "")
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="green", alpha=0.3, color="red")+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="#AA0033", alpha=0.3, color="blue")+
ggtitle('Mails')+
labs(x="palabra", y = "")
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="green", alpha=0.3)+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="#AA0033", alpha=0.3)+
ggtitle('Mails')+
labs(x="palabra", y = "")
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="green")+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="#AA0033")+
ggtitle('Mails')+
labs(x="palabra", y = "")
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="#00AA33")+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="#AA0033")+
ggtitle('Mails')+
labs(x="palabra", y = "")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red")) + geom_bar(stat="identity")+ ggtitle("Distribuci?n de clases") + labs(x="Categorias", y ="Distribuci?n(%)")
# en este caso estamos usando las propiedades visuales x y fill (relleno)
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red"))
+geom_bar(stat="identity")+ ggtitle("Distribuci?n de clases")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red"))
+geom_bar(stat="identity")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red"))
+ geom_bar(stat="identity")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red")) + geom_bar(stat="identity")
+ ggtitle("Distribuci?n de clases")
# quizas sea necesario instalar el paquete
# install.packages("ggplot2")
spam <- 0
nospam <- 0
spam <- length(which(m.train$matrix$category=="SPAM"))
nospam <- length(which(m.train$matrix$category=="NO-SPAM"))
distspam<-(spam/nrow(m.train$matrix))*100
distnospam <- (nospam/nrow(m.train$matrix))*100
distribucion = c(distspam, distnospam)
categorias <- c("spam", "no-spam")
distdata = data.frame(distribucion, categorias)
ggplot(data= distdata, aes(x=distdata$categorias, y=distdata$distribucion, fill="red")) +
geom_bar(stat="identity")  +
ggtitle("Distribuci?n de clases") +
labs(x="Categorias", y ="Distribuci?n(%)")
# en este caso estamos usando las propiedades visuales x y fill (relleno)
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="#00AA33")+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="#AA0033")+
ggtitle('Mails')+
labs(x="Frases", y = "")
#INSERTAR CODIGO AQUI
names(m.train$matrix)<- names(trainset)
spam<- subset(m.train$matrix, category == "SPAM")
noSpam<- subset(m.train$matrix, category == "NO-SPAM")
matrixSpam <- colSums(spam[1:(ncol(trainset)-1)] )
matrixNoSpam <- colSums(noSpam[1:(ncol(trainset)-1)] )
matrixSumaTotal <- colSums(m.train$matrix[1:(ncol(trainset)-1)] )
matrix <- data.frame(spam = matrixSpam, noSpam = matrixNoSpam, suma = matrixSumaTotal)
matrix <- matrix[order(matrix$suma,decreasing = TRUE),]
graphSet <- matrix[1:10,]
names <- row.names(graphSet)
# View(names)
ggplot(data= graphSet) +
geom_bar(aes(x = names, y= graphSet$noSpam), stat="identity", fill="#00AA33")+
geom_bar(aes(x = names, y= -(graphSet$spam)), stat="identity", fill="#AA0033")+
ggtitle('Mails')+
labs(x="Frases", y = "Cantidad")
index.cut <- (1:length(tokens))[tokens=="spam"|tokens=="httpaddr"|tokens=="news"] #devuelve los index de las palabras buscadas
trainset.cut <- trainset[-index.cut] ##deja el trainset sin las palabras buscadas en la linea anterior
tree.model.cut <- rpart(formula=category~.,data=trainset.cut)
prp(tree.model.cut)
# print(trainset.cut)
# instalar la libreria e1071
library("e1071")
install.packages("e1071")
# instalar la libreria e1071
library("e1071")
nb.model <- naiveBayes(formula=category~.,data=trainset.cut)
nb.model
# table(predict(nb, trainset.cut), trainset.cut[,ncol(trainset.cut)])
table(predict(nb.model, trainset.cut), trainset.cut[,ncol(trainset.cut)])
table(predict(nb.model, testset), testset[,ncol(testset)])
